<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student ID Card</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0073e6;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .id-card {
      width: 370px;
      background: #1ca64c;
      border: 2px solid #000;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0px 4px 10px rgba(0,0,0,0.3);
      color: white;
      display: none;
    }
    .id-card.active { display: block; }
    .logo {
      text-align: center;
      font-size: 22px;
      font-weight: bold;
      margin-bottom: 5px;
    }
    .university {
      text-align: center;
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 15px;
    }
    .photo {
      width: 100px;
      height: 100px;
      background: #ddd;
      color: black;
      border: 2px solid #000;
      border-radius: 10px;
      margin: 0 auto 15px auto;
      text-align: center;
      line-height: 100px;
      font-size: 12px;
      cursor: pointer;
      overflow: hidden;
      position: relative;
    }
    .photo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    #photoPreview { display: none; }
    .delete-photo {
      position: absolute;
      bottom: 2px;
      right: 2px;
      background: red;
      color: white;
      border: none;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      font-size: 12px;
      display: none;
      cursor: pointer;
    }
    input[type="file"] { display: none; }
    .details {
      font-size: 14px;
      margin-bottom: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }
    .details span { font-weight: bold; min-width: 130px; }
    input.box, input.readonly-box {
      flex: 1;
      height: 22px;
      border: 1px solid #000;
      border-radius: 3px;
      padding: 2px 5px;
      font-size: 13px;
    }
    input.readonly-box { background: #f0f0f0; color: #333; }
    .bottom-row {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      margin-top: 25px;
    }
    .qr canvas {
      width: 90px;
      height: 90px;
      border: 2px solid #000;
      border-radius: 6px;
      background: white;
    }
    .signature {
      text-align: center;
      color: white;
    }
    .signature-line {
      width: 100px;
      border-top: 1px solid #fff;
      margin: 5px auto 0 auto;
    }
    .submit-btn, .confirm-btn, .back-btn {
      display: block;
      width: 100%;
      margin-top: 15px;
      padding: 8px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: bold;
      background: #004d26;
      color: white;
      cursor: pointer;
    }
    .submit-btn:hover, .confirm-btn:hover { background: #00331a; }
    .back-btn { background: #990000; }
    .back-btn:hover { background: #660000; }
    .success-message {
      text-align: center;
      font-size: 16px;
      font-weight: bold;
      color: yellow;
      margin-top: 15px;
      display: none;
    }
  </style>
</head>
<body>
  <!-- PAGE 1: FORM -->
  <div class="id-card active" id="formPage">
    <form id="idForm">
      <div class="logo">ðŸŽ“ GehGeh</div>
      <div class="university">University of Wisdom and Understanding</div>

      <!-- Photo Upload -->
      <div class="photo" id="photoBox">
        <span id="photoText">Tap to Upload</span>
        <img id="photoPreview" alt="Student Photo">
        <button type="button" class="delete-photo" id="deletePhoto">x</button>
      </div>
      <input type="file" id="photoInput" accept="image/*">

      <div class="details"><span>Name:</span> <input type="text" id="name" class="box" required></div>
      <div class="details"><span>Other Names:</span> <input type="text" id="otherNames" class="box" required></div>
      <div class="details"><span>ID No:</span> <input type="text" id="idNumber" class="readonly-box" readonly></div>
      <div class="details"><span>Level:</span> <input type="text" id="level" class="box" required></div>
      <div class="details"><span>Department:</span> <input type="text" id="department" class="box" required></div>
      <div class="details"><span>Year of Admission:</span> <input type="text" id="admission" class="box" required></div>
      <div class="details"><span>Expiry Date:</span> <input type="text" id="expiry" class="box" required></div>

      <button type="submit" class="submit-btn">Submit</button>
    </form>
  </div>

  <!-- PAGE 2: CONFIRMATION -->
  <div class="id-card" id="confirmPage">
    <div class="logo">ðŸŽ“ GehGeh</div>
    <div class="university">University of Wisdom and Understanding</div>

    <div class="photo">
      <img id="confirmPhoto" alt="Student Photo">
    </div>

    <div class="details"><span>Name:</span> <span id="confirmName"></span></div>
    <div class="details"><span>Other Names:</span> <span id="confirmOtherNames"></span></div>
    <div class="details"><span>ID No:</span> <span id="confirmId"></span></div>
    <div class="details"><span>Level:</span> <span id="confirmLevel"></span></div>
    <div class="details"><span>Department:</span> <span id="confirmDepartment"></span></div>
    <div class="details"><span>Year of Admission:</span> <span id="confirmAdmission"></span></div>
    <div class="details"><span>Expiry Date:</span> <span id="confirmExpiry"></span></div>

    <div class="bottom-row">
      <div class="signature">
        Registrar
        <div class="signature-line"></div>
      </div>
      <div class="qr"><canvas id="qrCode"></canvas></div>
    </div>

    <button id="backBtn" class="back-btn">â¬… Go Back</button>
    <button id="confirmBtn" class="confirm-btn">âœ… Confirm</button>
  </div>

  <!-- PAGE 3: FINAL ID CARD -->
  <div class="id-card" id="finalPage">
    <div class="logo">ðŸŽ“ GehGeh</div>
    <div class="university">University of Wisdom and Understanding</div>

    <div class="photo">
      <img id="finalPhoto" alt="Student Photo">
    </div>

    <div class="details"><span>Name:</span> <span id="finalName"></span></div>
    <div class="details"><span>Other Names:</span> <span id="finalOtherNames"></span></div>
    <div class="details"><span>ID No:</span> <span id="finalId"></span></div>
    <div class="details"><span>Level:</span> <span id="finalLevel"></span></div>
    <div class="details"><span>Department:</span> <span id="finalDepartment"></span></div>
    <div class="details"><span>Year of Admission:</span> <span id="finalAdmission"></span></div>
    <div class="details"><span>Expiry Date:</span> <span id="finalExpiry"></span></div>

    <div class="bottom-row">
      <div class="signature">
        Registrar
        <div class="signature-line"></div>
      </div>
      <div class="qr"><canvas id="qrCodeFinal"></canvas></div>
    </div>

    <div class="success-message" id="successMsg">âœ… Registration Completed!</div>
  </div>

  <script>
    // Generate random student ID
    function generateID() {
      let year = new Date().getFullYear();
      let randomNum = Math.floor(1000 + Math.random() * 9000);
      return "GUWU/" + year + "/" + randomNum;
    }
    document.getElementById("idNumber").value = generateID();

    // Setup QR placeholders
    let qr = new QRious({
      element: document.getElementById("qrCode"),
      size: 90,
      value: "Student ID"
    });
    let qrFinal = new QRious({
      element: document.getElementById("qrCodeFinal"),
      size: 90,
      value: "Student ID"
    });

    // Photo upload
    const photoBox = document.getElementById("photoBox");
    const photoInput = document.getElementById("photoInput");
    const photoPreview = document.getElementById("photoPreview");
    const photoText = document.getElementById("photoText");
    const deletePhoto = document.getElementById("deletePhoto");
    const confirmPhoto = document.getElementById("confirmPhoto");
    const finalPhoto = document.getElementById("finalPhoto");

    photoBox.addEventListener("click", () => { photoInput.click(); });

    photoInput.addEventListener("change", function() {
      const file = this.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          photoPreview.src = e.target.result;
          photoPreview.style.display = "block";
          photoText.style.display = "none";
          deletePhoto.style.display = "block";
        };
        reader.readAsDataURL(file);
      }
    });

    deletePhoto.addEventListener("click", function(e) {
      e.stopPropagation();
      photoPreview.src = "";
      photoPreview.style.display = "none";
      photoText.style.display = "block";
      deletePhoto.style.display = "none";
    });

    // Handle form submission â†’ confirmation
    document.getElementById("idForm").addEventListener("submit", function(e) {
      e.preventDefault();

      // Fill confirmation page
      document.getElementById("confirmName").innerText = document.getElementById("name").value;
      document.getElementById("confirmOtherNames").innerText = document.getElementById("otherNames").value;
      document.getElementById("confirmId").innerText = document.getElementById("idNumber").value;
      document.getElementById("confirmLevel").innerText = document.getElementById("level").value;
      document.getElementById("confirmDepartment").innerText = document.getElementById("department").value;
      document.getElementById("confirmAdmission").innerText = document.getElementById("admission").value;
      document.getElementById("confirmExpiry").innerText = document.getElementById("expiry").value;
      confirmPhoto.src = photoPreview.src;

      // Update QR code
      qr.value = "ID: " + document.getElementById("idNumber").value;

      // Switch page
      document.getElementById("formPage").classList.remove("active");
      document.getElementById("confirmPage").classList.add("active");
    });

    // Go back to edit form
    document.getElementById("backBtn").addEventListener("click", function() {
      document.getElementById("confirmPage").classList.remove("active");
      document.getElementById("formPage").classList.add("active");
    });

    // Final confirm â†’ show issued ID card
    document.getElementById("confirmBtn").addEventListener("click", function() {
      document.getElementById("finalName").innerText = document.getElementById("name").value;
      document.getElementById("finalOtherNames").innerText = document.getElementById("otherNames").value;
      document.getElementById("finalId").innerText = document.getElementById("idNumber").value;
      document.getElementById("finalLevel").innerText = document.getElementById("level").value;
      document.getElementById("finalDepartment").innerText = document.getElementById("department").value;
      document.getElementById("finalAdmission").innerText = document.getElementById("admission").value;
      document.getElementById("finalExpiry").innerText = document.getElementById("expiry").value;
      finalPhoto.src = photoPreview.src;

      // Update final QR code
      qrFinal.value = "ID: " + document.getElementById("idNumber").value;

      // Switch page
      document.getElementById("confirmPage").classList.remove("active");
      document.getElementById("finalPage").classList.add("active");
      document.getElementById("successMsg").style.display = "block";
    });
  </script>
</body>
</html>
